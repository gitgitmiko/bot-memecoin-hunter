# PostgreSQL Configuration for 8GB VPS
# Optimized for memecoin-hunter application

#------------------------------------------------------------------------------
# MEMORY SETTINGS
#------------------------------------------------------------------------------

# Shared memory buffer (25% of allocated RAM = 512MB * 0.25 = 128MB)
shared_buffers = 128MB

# Effective cache size (75% of allocated RAM = 512MB * 0.75 = 384MB)
effective_cache_size = 384MB

# Maintenance work memory
maintenance_work_mem = 64MB

# Work memory per operation (4MB per connection, max 50 connections = 200MB max)
work_mem = 4MB

# Maximum number of connections
max_connections = 50

# WAL buffers
wal_buffers = 16MB

#------------------------------------------------------------------------------
# QUERY TUNING
#------------------------------------------------------------------------------

# Default statistics target
default_statistics_target = 100

# Random page cost (SSD optimized)
random_page_cost = 1.1

# Effective IO concurrency (SSD)
effective_io_concurrency = 200

#------------------------------------------------------------------------------
# CHECKPOINT SETTINGS
#------------------------------------------------------------------------------

# Checkpoint completion target (0.9 = spread checkpoints over 90% of checkpoint_timeout)
checkpoint_completion_target = 0.9

# Checkpoint timeout (default 5 minutes)
checkpoint_timeout = 5min

#------------------------------------------------------------------------------
# AUTOVACUUM
#------------------------------------------------------------------------------

# Enable autovacuum
autovacuum = on

# Autovacuum work memory
autovacuum_work_mem = 64MB

#------------------------------------------------------------------------------
# LOGGING
#------------------------------------------------------------------------------

# Log level
log_min_messages = warning
log_min_error_statement = error
log_min_duration_statement = 1000  # Log queries > 1 second

# Log connections and disconnections
log_connections = on
log_disconnections = on

# Log lock waits
log_lock_waits = on

# Log checkpoints
log_checkpoints = on

#------------------------------------------------------------------------------
# CPU SETTINGS
#------------------------------------------------------------------------------

# Max parallel workers per gather
max_parallel_workers_per_gather = 1

# Max parallel workers
max_parallel_workers = 2

# Max worker processes
max_worker_processes = 4

